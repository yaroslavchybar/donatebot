{
  "version": 3,
  "sources": ["../../../../../src/cli/lib/workos/workos.ts"],
  "sourcesContent": ["/**\n * Programatic provisioning of a WorkOS environments and configuration of these environemnts.\n *\n * This WorkOS integation is subject to change while in development and may require upgrading the CLI\n * to use in the future.\n *\n * This flow may be kicked off by discovering that WORKOS_CLIENT_ID\n * is required in a convex/auth.config.ts but not present on the deployment.\n */\nimport crypto from \"crypto\";\nimport { Context } from \"../../../bundler/context.js\";\nimport {\n  changeSpinner,\n  logFinishedStep,\n  logMessage,\n  logOutput,\n  logWarning,\n  showSpinner,\n  stopSpinner,\n} from \"../../../bundler/log.js\";\nimport { getTeamAndProjectSlugForDeployment } from \"../api.js\";\nimport { callUpdateEnvironmentVariables, envGetInDeployment } from \"../env.js\";\nimport { changedEnvVarFile, suggestedEnvVarName } from \"../envvars.js\";\nimport { promptOptions, promptYesNo } from \"../utils/prompts.js\";\nimport { createCORSOrigin, createRedirectURI } from \"./environmentApi.js\";\nimport {\n  createAssociatedWorkosTeam,\n  createEnvironmentAndAPIKey,\n  getCandidateEmailsForWorkIntegration,\n  getDeploymentCanProvisionWorkOSEnvironments,\n} from \"./platformApi.js\";\n\n/**\n * Ensure the current deployment has the three expected WorkOS environment\n * variables defined with values corresponding to a valid WorkOS deployment.\n *\n * This may involve provisioning a WorkOS deployment or even (in interactive\n * terminals only) prompting to provision a new WorkOS team to be associated\n * with this Convex team.\n */\nexport async function ensureWorkosEnvironmentProvisioned(\n  ctx: Context,\n  deploymentName: string,\n  deployment: {\n    deploymentUrl: string;\n    adminKey: string;\n    deploymentNotice: string;\n  },\n  options: {\n    offerToAssociateWorkOSTeam: boolean;\n    autoProvisionIfWorkOSTeamAssociated: boolean;\n    autoConfigureAuthkitConfig: boolean;\n    environmentName?: string;\n  },\n): Promise<\"ready\" | \"choseNotToAssociatedTeam\"> {\n  if (!options.autoConfigureAuthkitConfig) {\n    return \"choseNotToAssociatedTeam\";\n  }\n\n  showSpinner(\"Checking for associated AuthKit environment...\");\n  const existingEnvVars = await getExistingWorkosEnvVars(ctx, deployment);\n  if (\n    existingEnvVars.clientId &&\n    existingEnvVars.environmentId &&\n    existingEnvVars.apiKey\n  ) {\n    logOutput(\n      \"Deployment already has environment variables for a WorkOS environment configured for AuthKit.\",\n    );\n    await updateEnvLocal(\n      ctx,\n      existingEnvVars.clientId,\n      existingEnvVars.apiKey,\n      existingEnvVars.environmentId,\n    );\n    await updateWorkosEnvironment(ctx, existingEnvVars.apiKey);\n    logFinishedStep(\"WorkOS AutKit environment ready\");\n    return \"ready\";\n  }\n\n  // We need to provision an environment. Let's figure out if we can:\n  const response = await getDeploymentCanProvisionWorkOSEnvironments(\n    ctx,\n    deploymentName,\n  );\n  const { hasAssociatedWorkosTeam, teamId } = response;\n\n  // In case this this becomes a legacy flow that no longer works.\n  // @ts-expect-error - disabled is a legacy field that may not be present\n  if (response.disabled) {\n    return \"choseNotToAssociatedTeam\";\n  }\n  if (!hasAssociatedWorkosTeam) {\n    if (!options.offerToAssociateWorkOSTeam) {\n      return \"choseNotToAssociatedTeam\";\n    }\n    const result = await tryToCreateAssociatedWorkosTeam(\n      ctx,\n      deploymentName,\n      teamId,\n    );\n    if (result === \"choseNotToAssociatedTeam\") {\n      return \"choseNotToAssociatedTeam\";\n    }\n    result satisfies \"ready\";\n  }\n\n  const environmentResult = await createEnvironmentAndAPIKey(\n    ctx,\n    deploymentName,\n    options.environmentName,\n  );\n\n  if (!environmentResult.success) {\n    if (environmentResult.error === \"team_not_provisioned\") {\n      return await ctx.crash({\n        exitCode: 1,\n        errorType: \"fatal\",\n        printedMessage: `Team unexpectedly has no provisioned WorkOS team: ${environmentResult.message}`,\n      });\n    }\n    return await ctx.crash({\n      exitCode: 1,\n      errorType: \"fatal\",\n      printedMessage: environmentResult.message,\n    });\n  }\n\n  const data = environmentResult.data;\n  if (data.newlyProvisioned) {\n    logMessage(\"New AuthKit environment provisioned\");\n  } else {\n    logMessage(\n      \"Using credentials from existing AuthKit environment already created for this deployment\",\n    );\n  }\n\n  changeSpinner(\"Setting WORKOS_* deployment environment variables...\");\n  await setConvexEnvVars(\n    ctx,\n    deployment,\n    data.clientId,\n    data.environmentId,\n    data.apiKey,\n  );\n  showSpinner(\"Updating .env.local with WorkOS configuration\");\n  await updateEnvLocal(ctx, data.clientId, data.apiKey, data.environmentId);\n\n  await updateWorkosEnvironment(ctx, data.apiKey);\n  logFinishedStep(\"WorkOS AutKit environment ready\");\n\n  return \"ready\";\n}\n\n/**\n * Interactive flow to provision a WorkOS team for a Convex team.\n * Handles ToS agreement, email selection, and retry logic.\n */\nexport async function provisionWorkosTeamInteractive(\n  ctx: Context,\n  deploymentName: string,\n  teamId: number,\n  options: {\n    promptPrefix?: string;\n    promptMessage?: string;\n  } = {},\n): Promise<\n  | { success: true; workosTeamId: string; workosTeamName: string }\n  | { success: false; reason: \"cancelled\" }\n> {\n  const teamInfo = await getTeamAndProjectSlugForDeployment(ctx, {\n    deploymentName,\n  });\n  if (teamInfo === null) {\n    return await ctx.crash({\n      exitCode: 1,\n      errorType: \"fatal\",\n      printedMessage: `Can't find Convex Cloud team for deployment ${deploymentName}`,\n    });\n  }\n  stopSpinner();\n\n  const defaultPrefix = `A WorkOS team needs to be created for your Convex team \"${teamInfo.teamSlug}\" in order to use AuthKit.\n\nYou and other members of this team will be able to create WorkOS environments for each Convex dev deployment for projects in this team.\n\nBy creating this account you agree to the WorkOS Terms of Service (https://workos.com/legal/terms-of-service) and Privacy Policy (https://workos.com/legal/privacy).\nAlternately, choose no and set WORKOS_CLIENT_ID for an existing WorkOS environment.\n\\n`;\n\n  const defaultMessage = `Create a WorkOS team and enable automatic AuthKit environment provisioning for team \"${teamInfo.teamSlug}\"?`;\n\n  const agree = await promptYesNo(ctx, {\n    prefix: options.promptPrefix ?? defaultPrefix,\n    message: options.promptMessage ?? defaultMessage,\n  });\n  if (!agree) {\n    return { success: false, reason: \"cancelled\" };\n  }\n\n  const alreadyTried = new Map<string, string>();\n\n  let email;\n  while (true) {\n    let choice = \"refresh\";\n    while (choice === \"refresh\") {\n      const { availableEmails } =\n        await getCandidateEmailsForWorkIntegration(ctx);\n      choice = await promptOptions<string>(ctx, {\n        message:\n          availableEmails.length === 1\n            ? \"Create a new WorkOS team with this email address?\"\n            : \"Create a new WorkOS team with which email address?\",\n        suffix:\n          availableEmails.length === 0\n            ? \"\\nVisit https://dashboard.convex.dev/profile to add a verified email to use to provision a WorkOS account\"\n            : availableEmails.length === 1\n              ? \"\\nCreate a new WorkOS team with this email address?\"\n              : \"\\nTo use another email address visit https://dashboard.convex.dev/profile to add and verify, then choose 'refresh'\",\n        choices: [\n          ...availableEmails.map((email: string) => ({\n            name: `${email}${alreadyTried.has(email) ? ` (can't create, a WorkOS team already exists with this email)` : \"\"}`,\n            value: email,\n          })),\n          {\n            name: \"refresh (add an email at https://dashboard.convex.dev/profile)\",\n            value: \"refresh\",\n          } as const,\n          {\n            name: \"cancel (do not create a WorkOS account)\",\n            value: \"cancel\",\n          } as const,\n        ],\n      });\n    }\n    if (choice === \"cancel\") {\n      return { success: false, reason: \"cancelled\" };\n    }\n    email = choice;\n\n    const teamResult = await createAssociatedWorkosTeam(ctx, teamId, email);\n\n    if (teamResult.result === \"emailAlreadyUsed\") {\n      logMessage(teamResult.message);\n      alreadyTried.set(email, teamResult.message);\n      continue;\n    }\n    // Success!\n    return {\n      success: true,\n      workosTeamId: teamResult.workosTeamId,\n      workosTeamName: teamResult.workosTeamName,\n    };\n  }\n}\n\nexport async function tryToCreateAssociatedWorkosTeam(\n  ctx: Context,\n  deploymentName: string,\n  teamId: number,\n): Promise<\"ready\" | \"choseNotToAssociatedTeam\"> {\n  const result = await provisionWorkosTeamInteractive(\n    ctx,\n    deploymentName,\n    teamId,\n  );\n\n  if (!result.success) {\n    return \"choseNotToAssociatedTeam\";\n  }\n\n  logFinishedStep(\"WorkOS team created successfully\");\n  return \"ready\";\n}\n\n// Helpers\n\n// In the future this will be configurable.\n// Perhaps with an API like `authKit({ redirectUri: 'asdf' })\nasync function updateWorkosEnvironment(\n  ctx: Context,\n  workosApiKey: string,\n): Promise<void> {\n  let { frontendDevUrl } = await suggestedEnvVarName(ctx);\n  frontendDevUrl = frontendDevUrl || \"http://localhost:5173\";\n  const redirectUri = `${frontendDevUrl}/callback`;\n  const corsOrigin = `${frontendDevUrl}`;\n\n  await applyConfigToWorkosEnvironment(ctx, {\n    workosApiKey,\n    redirectUri,\n    corsOrigin,\n  });\n}\n\nasync function applyConfigToWorkosEnvironment(\n  ctx: Context,\n  {\n    workosApiKey,\n    redirectUri,\n    corsOrigin,\n  }: {\n    workosApiKey: string;\n    redirectUri: string;\n    corsOrigin: string;\n  },\n): Promise<void> {\n  changeSpinner(\"Configuring AuthKit redirect URI...\");\n  const { modified: redirectUriAdded } = await createRedirectURI(\n    ctx,\n    workosApiKey,\n    redirectUri,\n  );\n  if (redirectUriAdded) {\n    logMessage(`AuthKit redirect URI added: ${redirectUri}`);\n  }\n\n  changeSpinner(\"Configuring AuthKit CORS origin...\");\n  const { modified: corsAdded } = await createCORSOrigin(\n    ctx,\n    workosApiKey,\n    corsOrigin,\n  );\n  if (corsAdded) {\n    logMessage(`AuthKit CORS origin added: ${corsOrigin}`);\n  }\n}\n\n// Given a WORKOS_CLIENT_ID try to configure the .env.local appropriately\n// for a framework. This flow supports only Vite and Next.js for now.\nasync function updateEnvLocal(\n  ctx: Context,\n  clientId: string,\n  apiKey: string,\n  environmentId: string,\n) {\n  const envPath = \".env.local\";\n\n  const { frontendDevUrl, detectedFramework, publicPrefix } =\n    await suggestedEnvVarName(ctx);\n\n  // For now don't attempt for anything other than Vite or Next.js.\n  if (\n    !detectedFramework ||\n    ![\"Vite\", \"Next.js\", \"TanStackStart\"].includes(detectedFramework)\n  ) {\n    logWarning(\n      \"Can't configure .env.local, fill it out according to directions for the corresponding AuthKit SDK. Use `npx convex list` to see relevant environment variables.\",\n    );\n  }\n\n  let suggestedChanges: Record<\n    string,\n    {\n      value: string;\n      commentAfterValue?: string;\n      commentOnPreviousLine?: string;\n    }\n  > = {};\n\n  let existingFileContent = ctx.fs.exists(envPath)\n    ? ctx.fs.readUtf8File(envPath)\n    : null;\n\n  if (publicPrefix) {\n    if (detectedFramework === \"Vite\") {\n      suggestedChanges[`${publicPrefix}WORKOS_CLIENT_ID`] = {\n        value: clientId,\n        commentOnPreviousLine: `# See this environment at ${workosUrl(environmentId, \"/authentication\")}`,\n      };\n    } else if (\n      detectedFramework === \"Next.js\" ||\n      detectedFramework === \"TanStackStart\"\n    ) {\n      // Next/TanStack Start don\u2019t need the client id to be public\n      suggestedChanges[`WORKOS_CLIENT_ID`] = {\n        value: clientId,\n        commentOnPreviousLine: `# See this environment at ${workosUrl(environmentId, \"/authentication\")}`,\n      };\n    }\n\n    if (frontendDevUrl) {\n      suggestedChanges[\n        detectedFramework === \"TanStackStart\"\n          ? \"WORKOS_REDIRECT_URI\"\n          : `${publicPrefix}WORKOS_REDIRECT_URI`\n      ] = {\n        value: `${frontendDevUrl}/callback`,\n      };\n    }\n  }\n\n  if (\n    detectedFramework === \"Next.js\" ||\n    detectedFramework === \"TanStackStart\"\n  ) {\n    if (\n      !existingFileContent ||\n      !existingFileContent.includes(\"WORKOS_COOKIE_PASSWORD\")\n    ) {\n      suggestedChanges[\"WORKOS_COOKIE_PASSWORD\"] = {\n        value: crypto.randomBytes(32).toString(\"base64url\"),\n      };\n    }\n    suggestedChanges[\"WORKOS_API_KEY\"] = { value: apiKey };\n  }\n\n  for (const [\n    envVarName,\n    { value: envVarValue, commentOnPreviousLine, commentAfterValue },\n  ] of Object.entries(suggestedChanges) as [\n    string,\n    {\n      value: string;\n      commentOnPreviousLine?: string;\n      commentAfterValue?: string;\n    },\n  ][]) {\n    existingFileContent =\n      changedEnvVarFile({\n        existingFileContent,\n        envVarName,\n        envVarValue,\n        commentAfterValue: commentAfterValue ?? null,\n        commentOnPreviousLine: commentOnPreviousLine ?? null,\n      }) || existingFileContent;\n  }\n\n  if (existingFileContent !== null) {\n    ctx.fs.writeUtf8File(envPath, existingFileContent);\n    logMessage(\n      `Updated .env.local with ${Object.keys(suggestedChanges).join(\", \")}`,\n    );\n  }\n}\n\nasync function getExistingWorkosEnvVars(\n  ctx: Context,\n  deployment: {\n    deploymentUrl: string;\n    adminKey: string;\n  },\n): Promise<{\n  clientId: string | null;\n  environmentId: string | null;\n  apiKey: string | null;\n}> {\n  const [clientId, environmentId, apiKey] = await Promise.all([\n    envGetInDeployment(ctx, deployment, \"WORKOS_CLIENT_ID\"),\n    envGetInDeployment(ctx, deployment, \"WORKOS_ENVIRONMENT_ID\"),\n    envGetInDeployment(ctx, deployment, \"WORKOS_ENVIRONMENT_API_KEY\"),\n  ]);\n\n  return { clientId, environmentId, apiKey };\n}\n\nasync function setConvexEnvVars(\n  ctx: Context,\n  deployment: {\n    deploymentUrl: string;\n    adminKey: string;\n    deploymentNotice: string;\n  },\n  workosClientId: string,\n  workosEnvironmentId: string,\n  workosEnvironmentApiKey: string,\n) {\n  await callUpdateEnvironmentVariables(ctx, deployment, [\n    { name: \"WORKOS_CLIENT_ID\", value: workosClientId },\n    { name: \"WORKOS_ENVIRONMENT_ID\", value: workosEnvironmentId },\n    { name: \"WORKOS_ENVIRONMENT_API_KEY\", value: workosEnvironmentApiKey },\n  ]);\n}\n\ntype Subpaths = \"/authentication\" | \"/sessions\" | \"/redirects\" | \"/users\";\nfunction workosUrl(environmentId: string, subpath: Subpaths) {\n  return `https://dashboard.workos.com/${environmentId}${subpath}`;\n}\n"],
  "mappings": "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",
  "names": ["email"]
}
